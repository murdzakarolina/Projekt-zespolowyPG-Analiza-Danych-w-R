---
title: "Analiza danych w R - projekt zespołowy"
author: "Karolina Murdza, Alicja Hyży, Aleksandra Jakóbiak, Jan Freda"
date: "`r Sys.Date()`"
output:
  rmdformats::material:
    highlight: kate
---

````{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(cache = TRUE)
library(tidyverse)
library(readr)
library (naniar)
dane <- read.csv("data/Students_Social_Media_Addiction.csv")
````

# Wstęp

Celem projektu jest analiza danych dotyczących uzależnień od social mediów wśród studentów. Dane zawierają wiek, płeć, stopień wykształcenia, narodowość, najczęściej używana platforma, czas snu, zdrowie psychiczne, status związku. Głównym celem jest zbadanie, w jaki sposób korzystanie z mediów społecznościowych wpływa na uczniów:
1.	Wyniki w nauce
2.	Jakość snu

## Pytania badawcze

1.  Jaki jest średni czas jaki studenci spedzają dziennie na używanie social mediów?

2.  Jaka jest najczęściej używana przez studentów platforma?

3.  Jakie są różnice w czasie spędzanym na platformach social media w zależności od płci?

4.  Jaki jest średni czas snu w zależności od średniego czasu spędzanego na platformach social media?

5.  Jakie platformy społecznościowe najczęściej powodują objawy uzależnienia wśród studentów?

6.  Czy poziom wykształcenia wpływa na intensywność używania mediów społecznościowych?

7.  Czy status związku wpływa na czas spędzany w social mediach?

8.  Jaki jest średni czas spędzany w social mediach w zależności od narodowości?

9. Czy istnieją różnice w poziomie uzależnienia w zależności od narodowości studentów?

10. Czy poziom uzależnienia od mediów społecznościowych różni się między studentami płci żeńskiej i męskiej? 

### Opis danych 

Zbiór danych "Students_Social_Media_Addiction.csv" zawiera informacje o `r nrow(dane)` obserwacji i `r ncol(dane)` zmiennych.

Poniżej znajduje się opis najważniejszych zmiennych w zbiorze danych:

- `Age`: Wiek studenta (od 19 do 24 lat)

- `Gender`: Płeć studenta (Mężczyzna/Kobieta)

- `Academic_level`: Poziom wykształcenia (Średnie/Licencjat/Magister)

- `Country`: Narodowość studenta

- `Avg_Daily_Usage_Hours`: Średni dzienny czas spędzany na mediach społecznościowych (w godzinach - wartości od 1,5 do 8,5)

- `Most_Used_Platform`: Najczęściej używana platforma mediów społecznościowych (Facebook, Instagram, Twitter, TikTok, Snapchat, Inne)

- `Affects_Academic_Performance`: Wpływ na wyniki w nauce (Tak/Nie)

- `Sleep_Hours_Per_Night`: Liczba godzin snu na dobę (od 3,8 do 9,6 godzin)

- `Mental_Health_Score`: Wynik zdrowia psychicznego (skala od 1 do 10)

- `Relationship_Status`: Status związku (Single/In a relationship/Complicated)

- `Conflicts_Over_Social_Media`: Konflikty związane z używaniem mediów społecznościowych (skala od 1 do 5)

- `Addicted_Score`: Wynik uzależnienia od mediów społecznościowych (skala od 1 do 10) 

# 1. Porządkowanie i czyszczenie danych

# 1.1 Braki danych

```{r}
procent <- prop_complete_var(dane) *100
```

W danych znajduje się `r procent` % kompletnych wartości.

```{r}
naniar::vis_miss(dane)
```

## 1.2 Wzorzec braków danych

```{r}
library(finalfit)
missing_pattern(dane)
```

```{r}
VIM::aggr(dane, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(dane), cex.axis=.7, gap=3, ylab=c("Procent braków danych","Wzorzec braków danych"))
```


```{r}
library(ggplot2)
ggplot(data = dane) + 
  geom_miss_point(aes(x = Avg_Daily_Usage_Hours , y = Sleep_Hours_Per_Night))
```


## 1.3 Imputacje metodą hotdeck

```{r}
library(VIM)
Dane_imp <- hotdeck(dane)
naniar::vis_miss(Dane_imp)
```

# 2. Walidacja danych

**Definicja**

> Walidacja danych to proces sprawdzania poprawności, kompletności i spójności danych w celu zapewnienia ich jakości i wiarygodności. Polega na identyfikacji i eliminacji błędów, nieścisłości oraz braków danych, co pozwala na uzyskanie rzetelnych wyników analizy.

## Reguły 

```{r}
data(dane)
head(dane [3,7],3)
# dodajemy ID
dane$rec_id <- sprintf("ID%03d", 1:nrow(dane))
```

Reguły, które muszą spełnić nasze dane:

1. Wiek studentów mieści się w przedziale <16, 100>
2. Średni czas spędzany na platformach social media mieści się w przedziale <0, 24>
3. Średni czas snu na dobę mieści się w przedziale <0, 24>
4. Wynik zdrowia psychicznego mieści się w przedziale <0,10>
5. Wynik uzależnienia mieści się w przedziale <0,10>
6. Płeć to "Female", "Male" lub "Other"
7. Poziom wykształcenia to "Undergraduate", "Graduate", "High School"
8. Najczęściej używane platfomy to : "Instagram", "Facebook", "TikTok", "Snapchat", "LinkedIn", "LINE", "KakaoTalk", "Twitter", "VKontakte", "WeChat", "WhatsApp", "YouTube"
9. Status relacji to "Single", "In Relationship", "Complicated"
10. Wynik wpływu na wyniki akademickie to "Yes" lub "No"
11. Wynik konfliktu z social mediami to "0", "1", "2", "3", "4", "5"

```{r}
library(validate)

table(dane$Most_Used_Platform)
table(dane$Relationship_Status)
table(dane$Academic_Level)

rules <- validator(
  Age >= 16 & Age <= 100,
  Avg_Daily_Usage_Hours >= 0 & Avg_Daily_Usage_Hours <= 24,
  Sleep_Hours_Per_Night >= 0 & Sleep_Hours_Per_Night <= 24,
  Mental_Health_Score >= 0 & Mental_Health_Score <= 10,
  Addicted_Score >= 0 & Addicted_Score <= 10,
  Gender %in% c("Male", "Female", "Other"),
  Academic_Level %in% c("Undergraduate", "Graduate", "High School"),
  Most_Used_Platform %in% c("Instagram", "Facebook", "TikTok", "Snapchat", "LinkedIn", "LINE", "KakaoTalk", "Twitter", "VKontakte", "WeChat", "WhatsApp", "YouTube"),
  Relationship_Status %in% c("Single", "In Relationship", "Complicated"),
  Affects_Academic_Performance %in% c("Yes", "No"),
  Conflicts_Over_Social_Media %in% c("0", "1", "2", "3", "4", "5")
)

```

Czy zbiór danych spełnia te reguły?

```{r}
cf <- confront(dane, rules, key="rec_id")
summary(cf)
plot(cf, main="dane")
#as.data.frame(cf) %>% head()
```

W naszym zbiorze danych nie ma żadnego konfliktu danych; 100% reguł jest spełnione 
##  Zarądzenie regułami

**Problem**

W miarę rozwoju projektu, liczba reguł walidacyjnych może znacznie wzrosnąć, co utrudnia ich zarządzanie i utrzymanie. Ręczne dodawanie, modyfikowanie lub usuwanie reguł staje się czasochłonne i podatne na błędy.

**Pomysły**

Aurtomatyzacja zarządzania regułami walidacyjnymi może znacznie usprawnić proces walidacji danych.

```{r}


rules

```

# 3. Wizualizacja danych 

Sprawdzamy pytanie 4.Jaki jest średni czas snu w zależności od średniego czasu spędzanego na platformach social media? 

```{r}
#4.  Jaki jest średni czas snu w zależności od średniego czasu spędzanego na platformach social media i czy wpływa to na wynik akademicki? 

#wykres kropkowy z linią trendu 
  
library(ggplot2)
dane <- read.csv("data/Students_Social_Media_Addiction.csv")
ggplot(dane, aes(x = Sleep_Hours_Per_Night, y = Avg_Daily_Usage_Hours, color = Affects_Academic_Performance)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)  # linia trendu

#wykres boxplotowy z podziałem na kategorie wg sredniej czasu spedzanego na social mediach 

dane$Avg_Daily_Usage_Hours <- as.numeric(dane$Avg_Daily_Usage_Hours)
dane$social_media_avg <- cut(dane$Avg_Daily_Usage_Hours, breaks = c(0,2,4,6,8,10, Inf), labels = c("0-2", "2-4", "4-6", "6-8", "8-10", "wiecej niz 10"))
ggplot(dane, aes(y = Sleep_Hours_Per_Night, x = social_media_avg)) + 
  geom_boxplot()
```

Średnia czasu spędzanego na platforach social media jest odwrotnie proporcjonalna do średniego czasu snu. 
Na podstawie pierwszego wykresu można zauważyć, że osoby, na których wyniki akademickie wpływa czas spędzony na social mediach śpią średnio krócej i spędzają więcej czasu na platformach społecznościowych. 

Na podstawie drugiego wykresu można zauważyć ujemną korelację średniej czasu snu ze średnią czasu spędzonego w social mediach. 



